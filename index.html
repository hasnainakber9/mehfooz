<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mehfooz | Clarity in the Digital Crossroads</title>
    
    <script src="https://cdn.tailwindcss.com"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/lenis@1.0.45/dist/lenis.min.js"></script>
    <script src="https://unpkg.com/split-type"></script> <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&family=Special+Elite&family=Ubuntu:wght@400;500;700&display=swap" rel="stylesheet">


    <style>
        /* ---
        SOPHISTICATED THEME (NAVY/TEAL/GOLD) - REAPPLIED
        ---
        */
        :root {
            --dark-bg: #0F172A; /* Deep Navy */
            --light-text: #E2E8F0;
            --medium-text: #94A3B8;
            --card-bg: #1E293B; /* Slightly lighter navy */
            --border-color: #334155;
            --gold: #F4B860;
            --teal: #00A896;
            --danger: #ef4444;
            --success: #22c55e;

            /* *** UPDATED FONT VARIABLES *** */
            --font-sans: 'Ubuntu', sans-serif; /* Ubuntu for body */
            --font-heading: 'Poppins', sans-serif; /* Poppins for headings */
            --font-script: 'Special Elite', cursive; /* Special Elite for script */
        }

        /* Removed previous font import */

        html.lenis { height: auto; }
        .lenis.lenis-smooth { scroll-behavior: auto; }

        body {
            background-color: var(--dark-bg);
            color: var(--light-text);
            /* *** APPLY UBUNTU TO BODY *** */
            font-family: var(--font-sans);
            overflow-x: hidden;
            cursor: none;
        }
        
        .antialiased {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* ---
        INTIMATE CURSOR
        ---
        */
        #cursor-light {
            position: fixed;
            width: 800px; height: 800px;
            border-radius: 50%;
            left: 0; top: 0;
            pointer-events: none;
            background: radial-gradient(circle, rgba(244, 184, 96, 0.07) 0%, transparent 60%);
            transform: translate(-50%, -50%);
            z-index: 9999;
            transition: transform 0.3s ease-out, opacity 0.3s ease;
             opacity: 0; /* Hidden initially */
        }
        #cursor-dot {
            position: fixed;
            width: 6px; height: 6px;
            background-color: var(--gold);
            border-radius: 50%;
            left: 0; top: 0;
            pointer-events: none;
            transform: translate(-50%, -50%);
            z-index: 10000;
             transition: transform 0.3s ease, background-color 0.3s ease, opacity 0.3s ease;
            opacity: 0; /* Hidden initially */
        }
        body:hover > #cursor-light,
        body:hover > #cursor-dot {
            opacity: 1;
        }
        /* Cursor hover state */
        a:hover ~ #cursor-dot,
        button:hover ~ #cursor-dot,
        select:hover ~ #cursor-dot {
            transform: translate(-50%, -50%) scale(1.5);
            background-color: var(--teal);
        }
        a:hover ~ #cursor-light,
        button:hover ~ #cursor-light,
        select:hover ~ #cursor-light {
            transform: translate(-50%, -50%) scale(1.2);
        }
        
        #bg-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100vh;
            z-index: -1;
            opacity: 0; /* Fade in */
            transition: opacity 1s ease 0.5s;
        }
        body.site-entered #bg-canvas {
            opacity: 1;
        }

        .content-section {
            position: relative;
            z-index: 1;
            /* padding: 20vh 0;  REMOVED - Use specific section padding */
        }
        
        /* ---
        ENHANCED GAME STYLES - AESTHETIC & INTIMATE
        ---
        */
        #game-screen {
            background: linear-gradient(180deg, var(--dark-bg) 0%, #0c121e 100%); /* Subtle gradient */
        }
        .game-card-container { /* New container for centering and padding */
             display: flex;
             align-items: center;
             justify-content: center;
             min-height: 100vh;
             padding: 2rem;
        }
        .game-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1rem; /* Softer rounding */
            padding: 2.5rem 2rem; /* More padding */
             max-width: 600px; /* Constrain width */
             width: 100%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            position: relative; /* For potential pseudo-elements */
            overflow: hidden; /* For effects */
            opacity: 0; /* Start hidden for GSAP */
            transform: scale(0.95); /* Start smaller for GSAP */
        }
         /* Subtle animated border/glow */
         .game-card::before {
             content: '';
             position: absolute;
             top: 0; left: 0; right: 0; bottom: 0;
             border-radius: inherit;
             border: 1px solid transparent;
             background: linear-gradient(160deg, var(--teal), var(--gold)) border-box;
             -webkit-mask:
                 linear-gradient(#fff 0 0) padding-box,
                 linear-gradient(#fff 0 0);
             -webkit-mask-composite: destination-out;
             mask-composite: exclude;
             opacity: 0;
             transition: opacity 0.5s ease;
             z-index: 0;
             pointer-events: none; /* Allow clicks through */
         }
         .game-card:hover::before { /* Gentle glow on hover */
             opacity: 0.3;
         }

        .game-content { /* Inner container for easier GSAP targeting */
             position: relative; z-index: 1;
        }

        .game-statement-card {
            background: rgba(15, 23, 42, 0.5); /* Darker, more integrated */
            border: 1px solid var(--border-color);
            min-height: 12rem; /* Ensure space */
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            border-radius: 0.75rem; /* Match card rounding */
            padding: 1.5rem;
             /* font-style: italic; /* Removed italic */
             color: var(--light-text); /* Slightly brighter */
             box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);
             font-family: var(--font-sans); /* Use Ubuntu */
             font-size: 1.1rem; /* Adjust size if needed */
             line-height: 1.6;
        }
        .game-btn {
            background-color: rgba(255, 255, 255, 0.05); /* Lighter bg */
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            color: var(--medium-text);
            border-radius: 99px; /* Pill shape */
             padding: 0.8rem 1.5rem; /* Adjust padding */
             font-weight: 500;
             font-family: var(--font-heading); /* Use Poppins for buttons */
        }
        .game-btn:hover:not(:disabled) {
            transform: translateY(-3px) scale(1.03); /* More lift */
            background-color: var(--teal);
            border-color: var(--teal);
            color: white; /* White text on hover */
            box-shadow: 0 8px 20px rgba(0, 168, 150, 0.25);
        }
        .game-btn.gold { /* Keep gold class for styling the Begin button */
             background-color: var(--gold);
             color: var(--dark-bg);
             border-color: var(--gold);
        }
        .game-btn.gold:hover:not(:disabled) {
            background-color: var(--teal); /* Change hover for gold button too */
            border-color: var(--teal);
            color: white;
             box-shadow: 0 8px 20px rgba(0, 168, 150, 0.25);
        }
        .game-btn:disabled {
            opacity: 0.4;
            cursor: none;
        }

        #enter-site-btn {
            background-color: var(--gold);
            color: var(--dark-bg);
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(244, 184, 96, 0.2);
            border-radius: 99px;
             font-weight: 700; /* Bolder */
             padding: 0.9rem 2rem; /* Larger */
             font-family: var(--font-heading); /* Use Poppins */
        }
        #enter-site-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(244, 184, 96, 0.35);
        }
        
         #game-feedback {
             /* font-style: italic; */ /* Removed italic */
             color: var(--medium-text);
             min-height: 3rem; /* Ensure space for feedback */
             font-family: var(--font-sans); /* Use Ubuntu */
             font-size: 1rem;
         }
         
         /* Specific font application for game */
         #game-intro h2, #game-end h3 { font-family: var(--font-script); } /* Special Elite */
         #game-intro p, #game-end p { font-family: var(--font-sans); } /* Ubuntu */
         #game-main p#game-prompt { font-family: var(--font-heading); font-weight: 500;} /* Poppins */
         #game-main #game-statement { font-family: var(--font-sans);} /* Ubuntu */


        /* Animate-in styles */
        .reveal-up { opacity: 0; transform: translateY(40px); }

        /* ---
        TYPOGRAPHY & FONT APPLICATION
        ---
        */
        /* *** USE SPECIAL ELITE FOR SCRIPT ELEMENTS *** */
        .font-script { font-family: var(--font-script); }

        /* *** USE POPPINS FOR ALL HEADINGS *** */
        h1, h2, h3 { font-family: var(--font-heading); font-weight: 700; }
        h1 { font-size: clamp(2.5rem, 5vw + 1rem, 4.5rem); letter-spacing: -0.01em; } /* Adjust spacing */
        h2 { font-size: clamp(2rem, 4vw, 3rem); font-weight: 700; }
        h3 { font-size: 1.5rem; font-weight: 500; color: var(--light-text); } /* Lighter weight for H3 */

        /* *** USE UBUNTU FOR PARAGRAPHS (already applied via body) *** */
        p {
            font-size: 1.125rem;
            line-height: 1.7;
            color: var(--medium-text);
            max-width: 65ch;
            font-weight: 400; /* Standard weight */
        }
        blockquote p { /* Ensure blockquotes use body font */
             font-family: var(--font-sans);
        }

        /* --- Apply Poppins to specific buttons/nav items for consistency --- */
         .btn, .nav-link, #friendly-nav .nav-link, .chat-prompt-btn, .question-pill {
             font-family: var(--font-heading); /* Poppins for UI elements */
             font-weight: 500;
         }
         #contact-form label { font-family: var(--font-heading); font-weight: 500; }
         #contact-form button { font-family: var(--font-heading); font-weight: 700; }


        /* ---
        CHAT & FORM STYLES (SOPHISTICATED)
        ---
        */
        .chat-bubble { max-width: 75%; padding: 12px 18px; border-radius: 18px; line-height: 1.5; font-family: var(--font-sans); } /* Ubuntu in chat */
        .user-bubble { background-color: var(--teal); color: white; border-bottom-right-radius: 4px; align-self: flex-end; }
        .bot-bubble { background-color: var(--card-bg); color: var(--light-text); border-bottom-left-radius: 4px; align-self: flex-start; }

        .chat-prompt-btn {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--medium-text);
            transition: all 0.3s ease;
             border-radius: 99px; /* Pill */
             padding: 0.5rem 1rem; /* Adjust padding */
             font-size: 0.875rem; /* Smaller text */
        }
        .chat-prompt-btn:hover {
            background-color: var(--teal);
            border-color: var(--teal);
            color: white;
            transform: translateY(-2px);
             box-shadow: 0 4px 10px rgba(0, 168, 150, 0.2);
        }
        
        .form-input {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--light-text);
            border-radius: 8px; /* Consistent rounding */
            padding: 0.875rem 1rem;
            transition: all 0.3s ease;
            width: 100%;
             font-family: var(--font-sans); /* Ubuntu for inputs */
        }
        .form-input:focus {
            outline: none;
            border-color: var(--teal);
            box-shadow: 0 0 0 3px rgba(0, 168, 150, 0.3);
        }
        /* Style select arrow */
        select.form-input {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%2394A3B8' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.7rem center;
            background-size: 1.2em 1.2em;
            padding-right: 2.5rem;
        }
        
        .btn-teal {
             background-color: var(--teal);
             color: white;
             transition: all 0.3s ease;
             border-radius: 99px; /* Pill shape */
        }
        .btn-teal:hover {
            background-color: var(--gold);
            color: var(--dark-bg);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 168, 150, 0.3);
        }

        /* ---
        FRIENDLY NAVIGATION
        ---
        */
        #friendly-nav {
            transform: translateY(200%);
            transition: transform 0.8s cubic-bezier(0.19, 1, 0.22, 1);
            position: fixed; /* Ensure it's fixed */
            bottom: 2rem; /* Adjusted position */
            left: 50%;
            z-index: 50;
            background: rgba(30, 41, 59, 0.7); /* card-bg with transparency */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 99px; /* Pill shape */
            padding: 0.5rem 1rem; /* Adjust padding */
        }
        #friendly-nav.visible {
            transform: translate(-50%, 0); /* Centering */
        }
        #friendly-nav .nav-link { /* Target specifically within friendly nav */
             color: var(--medium-text);
             position: relative; /* Needed for ::after */
             padding: 0.5rem 1rem; /* Adjust padding */
             font-size: 1rem; /* Slightly smaller */
             /* font-weight: 500; Already set */
        }
         #friendly-nav .nav-link:hover {
             color: var(--light-text);
         }
        #friendly-nav .nav-link.active {
            color: var(--gold);
        }
         /* Underline style */
        #friendly-nav .nav-link::after {
            content: '';
            position: absolute;
            bottom: 2px; /* Closer to text */
            left: 10%; /* Indent underline */
            width: 80%; /* Shorter underline */
            height: 2px;
            background: var(--gold);
            transform: scaleX(0);
            transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
            transform-origin: center; /* Animate from center */
        }
        #friendly-nav .nav-link.active::after {
            transform: scaleX(1);
        }
        #friendly-nav .nav-link:not(.active):hover::after {
            transform: scaleX(0.5); /* Subtle hint on hover */
             background: var(--light-text);
        }
        
        .value-icon {
            stroke-width: 1;
            transition: all 0.4s ease;
            color: var(--medium-text); /* Use color for SVG stroke */
        }
        .value-container:hover .value-icon {
            transform: scale(1.1);
            color: var(--gold); /* Use color for SVG stroke on hover */
        }
        
        /* General button/link styles */
        button, a, select {
            cursor: none; /* Apply custom cursor */
        }
        
        /* Ensure sections stack correctly */
        section {
            padding: 100px 0; /* Consistent padding */
        }
        #home { /* Override for hero */
             min-height: 100vh;
            padding: 0;
        }
         #journal, #approach, #community, #vision, #values, #connect {
            padding-top: 120px; /* Standard top padding */
             padding-bottom: 120px; /* Standard bottom padding */
         }

         /* ---
         PRELOADER STYLES (MATCH THEME)
         ---
         */
        #loader {
            background-color: var(--dark-bg);
        }
        .loader-logo path:nth-child(1) { fill: var(--gold); opacity: 0.1; }
        .loader-logo path:nth-child(2) { fill: var(--gold); opacity: 0.3; }
        .loader-logo path:nth-child(3) { fill: var(--gold); }

        /* ---
        HEADER STYLES (MATCH THEME)
        ---
        */
        #site-header {
             /* Initial state is transparent */
             opacity: 0; /* Start hidden */
             transform: translateY(-100%);
        }
        #site-header.scrolled {
            background: rgba(15, 23, 42, 0.7); /* dark-bg with transparency */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        .nav-logo { color: var(--gold); }
         /* Adjust desktop nav link style */
        #site-header .nav-link { color: var(--light-text); }
        #site-header .nav-link:hover { color: var(--gold); }
         #site-header .nav-link.btn-outline { border-color: var(--teal); color: var(--teal); }
         #site-header .nav-link.btn-outline:hover { background-color: var(--teal); color: white; }

        /* ---
        HERO STYLES (MATCH THEME)
        ---
        */
        /* #hero-headline { color: var(--gold); } Already handled by .font-script */
        #hero-subheadline { color: var(--light-text); }
         #scroll-prompt span { font-family: var(--font-heading); font-weight: 500;} /* Poppins for prompt */
         .mouse { border-color: var(--medium-text);}
         .mouse::before { background-color: var(--medium-text); }

        /* ---
        JOURNAL STYLES (MATCH THEME)
        ---
        */
        #journal h2 { color: var(--gold); font-family: var(--font-script); } /* Script font for Journal */
        #journal p { color: var(--medium-text); }
        .journal-image-container { /* Add reveal animation */
            opacity: 0;
            clip-path: inset(10% 30% 10% 30%);
            transform: scale(1.1);
        }


        /* ---
        APPROACH STYLES (MATCH THEME)
        ---
        */
        #approach h2 { color: var(--gold); font-family: var(--font-script); } /* Script font */
        #approach h3 { color: var(--teal); font-family: var(--font-script); } /* Script font */
        #approach p { color: var(--medium-text); }
        .pillar-card { /* Styles for pillar cards in Approach */
             background-color: var(--card-bg);
             border: 1px solid var(--border-color);
             /* Other pillar styles */
         }
        
        /* ---
        COMMUNITY STYLES (MATCH THEME)
        ---
        */
        #community h2 { color: var(--gold); font-family: var(--font-script); } /* Script font */
        #community h3 { color: var(--teal); font-family: var(--font-script); } /* Script font */
        #community blockquote { border-color: var(--gold); color: var(--medium-text); }
        #community cite { color: var(--light-text); }

        /* ---
        VISION STYLES (MATCH THEME)
        ---
        */
        #vision h2 { color: var(--gold); font-family: var(--font-script); } /* Script font */
        #vision p.text-medium-text { color: var(--medium-text); }
        #vision .font-script.text-teal { color: var(--teal); font-family: var(--font-script); } /* Ensure script font */
        #vision h3 { color: var(--light-text); font-family: var(--font-heading); } /* Poppins for subheads */
        #vision .btn-outline { border-color: var(--teal); color: var(--teal); }
        #vision .btn-outline:hover { background-color: var(--teal); color: white; }


        /* ---
        VALUES STYLES (MATCH THEME)
        ---
        */
        #values h2 { color: var(--gold); font-family: var(--font-script); } /* Script font */
        #values h3 { color: var(--teal); font-family: var(--font-script); } /* Script font */
        #values p { color: var(--medium-text); }

        /* ---
        CONNECT STYLES (MATCH THEME)
        ---
        */
        #connect h2 { color: var(--gold); font-family: var(--font-script); } /* Script font */
        #connect p.text-medium-text { color: var(--medium-text); }
        #connect h3 { color: var(--teal); font-family: var(--font-script); } /* Script font */
        #connect label { color: var(--medium-text); }
        #connect #form-success h3 { color: var(--teal); font-family: var(--font-script); } /* Script font */
        #connect #form-success p { color: var(--medium-text); }
        #chat-log { background-color: rgba(15, 23, 42, 0.5); /* Darker chat log */ }
        
        /* ---
        BOT STYLES (MATCH THEME)
        ---
        * / Bot Modal Styles - Keeping separate for clarity if used */
        #bot-modal { background-color: rgba(15, 23, 42, 0.7); }
        .bot-modal-content { background-color: var(--dark-bg); border-color: var(--border-color); }
        .bot-modal-content h3 { color: var(--gold); font-family: var(--font-script); } /* Script font */
        .bot-modal-content p { color: var(--medium-text); }
        #close-bot-demo { color: var(--medium-text); }
        #close-bot-demo:hover { color: var(--light-text); }
        #bot-modal #chat-log { background-color: var(--card-bg); } /* Specific if in modal */
        #question-pills-container .question-pill { /* Style pills if used */
             border-color: var(--medium-text); color: var(--medium-text); font-family: var(--font-heading); font-size: 0.875rem;}
         #question-pills-container .question-pill:hover {
            background-color: var(--teal); border-color: var(--teal); color: white; }
        #bot-modal #chat-form input { /* Specific if in modal */ font-family: var(--font-sans); }
        #bot-modal #chat-form button { /* Specific if in modal */ font-family: var(--font-heading); }


        /* ---
        FOOTER STYLES (MATCH THEME)
        ---
        */
        #site-footer { border-color: var(--border-color); }
        #site-footer p { color: var(--medium-text); }


    </style>
</head>
<body class="antialiased">

    <div id="loader">
        <svg class="loader-logo" width="80" height="93" viewBox="0 0 80 93" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M40 0L79.0526 23.25V69.75L40 93L0.947441 69.75V23.25L40 0Z"/>
            <path d="M40 9.3L71.0526 27.9V65.1L40 83.7L8.94744 65.1V27.9L40 9.3Z"/>
            <path d="M40 18.6L63.0526 32.55V60.45L40 74.4L16.9474 60.45V32.55L40 18.6Z"/>
        </svg>
    </div>

    <div id="cursor-light"></div>
    <div id="cursor-dot"></div>
    
    <canvas id="bg-canvas"></canvas>

    <div id="game-screen" class="fixed inset-0 z-[101] flex items-center justify-center p-4 transition-opacity duration-500">
        <div class="game-card-container"> <div class="game-card"> <div class="game-content"> <div id="game-intro">
                        <h2 class="font-script text-gold text-4xl md:text-5xl mb-2">A Quiet Moment</h2>
                        <p class="text-medium-text text-lg mb-8">The digital world is full of voices.<br>Let's take a moment to listen to our own intuition.</p>
                        <button id="game-start-btn" class="game-btn gold font-bold py-3 px-8 rounded-lg text-xl">Begin</button>
                    </div>
                    
                    <div id="game-main" class="hidden">
                        <p id="game-prompt" class="text-lg text-teal mb-4 text-center"></p>
                        <div id="game-statement" class="game-statement-card rounded-lg p-6 md:p-8 text-xl md:text-2xl mb-6">
                            </div>
                        <div id="game-buttons" class="flex flex-col md:flex-row gap-4 justify-center">
                            <button id="game-btn-1" class="game-btn text-lg py-3 px-6 rounded-lg w-full md:w-auto"></button>
                            <button id="game-btn-2" class="game-btn text-lg py-3 px-6 rounded-lg w-full md:w-auto"></button>
                        </div>
                        <p id="game-feedback" class="mt-6 text-lg max-w-xl mx-auto min-h-[4rem] text-center"></p>
                    </div>

                    <div id="game-end" class="hidden text-center">
                        <h3 class="font-script text-teal text-4xl mb-4">A Thoughtful Heart</h3>
                        <p class="text-xl text-medium-text mb-8">Clarity isn't about knowing all the answers, but asking the right questions. You are ready.</p>
                        <button id="enter-site-btn" class="font-bold py-3 px-8 rounded-lg text-xl">Enter Mehfooz</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <main id="main-content" class="opacity-0">
        <header id="site-header" class="fixed top-0 left-0 w-full z-50"> <nav class="container mx-auto flex justify-between items-center p-6 md:p-8">
                <a href="#home" class="nav-logo font-script text-3xl">Mehfooz</a>
                <div class="hidden md:flex gap-6 text-lg items-center"> <a href="#journal" class="nav-link relative">Journal</a>
                    <a href="#approach" class="nav-link relative">Approach</a>
                    <a href="#community" class="nav-link relative">Community</a>
                    <a href="#connect" class="nav-link relative">Connect</a>
                     <a href="#connect" class="nav-link btn btn-outline ml-4">Join Us</a>
                </div>
                 <div class="md:hidden">
                      </div>
            </nav>
        </header>

        <section id="home" class="content-section h-screen flex items-center justify-center text-center">
             <div class="hero-background"> <img src="https://images.unsplash.com/photo-1623581203333-53531b1bbf8e?q=80&w=2400&auto=format=fit=crop"
                      alt="A thoughtful portrait of a person from Gilgit Baltistan">
             </div>
            <div class="px-4 hero-content container relative z-10"> <h1 id="hero-headline" class="text-gold text-5xl md:text-8xl mb-4 font-script"> Clarity in the Digital Crossroads.
                </h1>
                <p id="hero-subheadline" class="text-xl md:text-2xl text-light-text leading-relaxed max-w-4xl mx-auto"> For the people of Gilgit Baltistan, a safe space to find clarity in a connected world.
                </p>
                 <div id="scroll-prompt" class="absolute bottom-16 left-1/2 -translate-x-1/2 opacity-0"> <div class="mouse w-6 h-10 border-2 border-medium-text rounded-full relative"> <div class="w-1 h-2 bg-medium-text rounded-full absolute left-1/2 transform -translate-x-1/2 animate-scroll-wheel"></div> <style> @keyframes scroll-wheel { 0% { top: 6px; opacity: 1; } 100% { top: 20px; opacity: 0; } } .animate-scroll-wheel { animation: scroll-wheel 1.5s infinite; } </style>
                     </div>
                    <span class="mt-2 text-medium-text animate-pulse">Scroll to Discover</span> </div>
            </div>
        </section>

        <section id="journal" class="content-section py-20 md:py-40 journal-section"> <div class="container mx-auto px-6 max-w-4xl">
                 <div class="flex flex-col md:flex-row gap-12 items-center">
                     <div class="w-full md:w-1/2">
                         <div class="journal-image-container rounded-lg shadow-2xl shadow-black/50"> <img src="https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=2070&auto-format=fit=crop" alt="A diverse group of people from Skardu warmly interacting and learning together" class="w-full h-full object-cover">
                         </div>
                     </div>
                     <div class="w-full md:w-1/2">
                         <h2 class="font-script text-gold text-5xl md:text-6xl mb-4 reveal-up">From Our Journal</h2>
                         <p class="text-lg text-medium-text leading-relaxed mb-6 reveal-up">Mehfooz began not with a line of code, but with a conversation. In a small <strong>Skardu</strong> teahouse, over cups of warm chai, we listened. We heard stories of connection and confusion, of hope and fear in a new digital world where progress was meeting peril.</p>
                         <p class="text-lg text-medium-text leading-relaxed reveal-up">We learned that the need wasn't for more technology, but for more understanding. For a bridge between timeless wisdom and modern tools. Mehfooz is our promise to help build that bridge, together.</p>
                     </div>
                 </div>
             </div>
        </section>

        <section id="approach" class="content-section py-20 md:py-40">
            <div class="container mx-auto px-6 max-w-5xl">
                <div class="text-center reveal-up mb-20 section-header"> <h2 class="font-script text-gold text-5xl md:text-6xl mb-4">Our Approach is Simple</h2>
                </div>
                <div class="grid md:grid-cols-3 gap-12 text-center">
                    <div class="pillar-card reveal-up">
                        <div class="pillar-content">
                            <h3 class="font-script text-teal text-4xl mb-3">Listen First</h3>
                            <p class="text-medium-text leading-relaxed">We don't just provide information; we build on existing foundations of trust by collaborating with local religious leaders (Ulema) as trusted digital literacy ambassadors.</p>
                        </div>
                    </div>
                     <div class="pillar-card reveal-up">
                        <div class="pillar-content">
                            <h3 class="font-script text-teal text-4xl mb-3">Guide Gently</h3>
                            <p class="text-medium-text leading-relaxed">Harnessing AI, MehfoozBot offers personal, patient help, adapting to each user's language and learning style, making technology feel like a friend.</p>
                             <button id="open-bot-demo-approach" class="btn btn-secondary mt-6">See MehfoozBot</button>
                        </div>
                    </div>
                     <div class="pillar-card reveal-up">
                         <div class="pillar-content">
                            <h3 class="font-script text-teal text-4xl mb-3">Grow Together</h3>
                            <p class="text-medium-text leading-relaxed">Through short, localized mini-courses and a unique feedback ecosystem with local college students, we ensure our knowledge is always relevant and co-created.</p>
                         </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="community" class="content-section py-20 md:py-40">
            <div class="container mx-auto px-6 max-w-4xl">
                 <div class="text-center reveal-up section-header"> <h2 class="font-script text-gold text-5xl md:text-6xl mb-4">The Heart of Our Community</h2>
                 </div>
                 <div class="mt-16 reveal-up">
                     <h3 class="font-script text-teal text-4xl mb-6 text-center">Voices from the Valley</h3>
                     <div class="space-y-8">
                         <blockquote class="border-l-4 border-gold pl-6 italic text-lg text-medium-text">"For the first time, I felt I could ask a 'silly' question about my phone without feeling embarrassed. MehfoozBot helped me understand."<cite class="block not-italic mt-2 text-light-text">- A student from Gilgit</cite></blockquote>
                         <blockquote class="border-l-4 border-gold pl-6 italic text-lg text-medium-text text-right">"They didn’t come to teach; they came to learn with us. That is why we trust them."<cite class="block not-italic mt-2 text-light-text">- An elder from <strong>Skardu</strong></cite></blockquote>
                     </div>
                 </div>
            </div>
        </section>
        
        <section id="vision" class="content-section py-20 md:py-40">
              <div class="container mx-auto px-6 max-w-4xl text-center">
                  <div class="reveal-up section-header"> <h2 class="font-script text-gold text-5xl md:text-6xl mb-4">Our Five-Year Vision</h2>
                      <p class="text-xl text-medium-text max-w-3xl mx-auto">To scale our impact together, offering an opportunity for partners to co-create a digitally resilient future.</p>
                  </div>
                  <div class="mt-16 grid md:grid-cols-2 gap-x-12 gap-y-16 text-left">
                      <div class="reveal-up">
                          <p class="font-script text-teal text-7xl" id="user-counter">0</p>
                          <h3 class="text-2xl mt-2">Empowered Users Across Pakistan</h3>
                          <p class="text-medium-text mt-2">Leveraging our established educational networks and community structures for organic, sustainable growth.</p>
                      </div>
                      <div class="reveal-up">
                           <p class="font-script text-teal text-7xl">3+</p>
                          <h3 class="text-2xl mt-2">Platform Evolutions</h3>
                          <p class="text-medium-text mt-2">Introducing AI-driven learning paths, enhanced offline capabilities for remote areas, and expanded indigenous language support.</p>
                      </div>
                       <div class="reveal-up">
                           <h3 class="font-script text-teal text-5xl mb-3">Deepened Integration</h3>
                           <p class="text-medium-text mt-2">Strengthening our partnerships with educational institutions, community figures, and policymakers to ensure lasting adoption and impact.</p>
                      </div>
                      <div class="reveal-up">
                           <h3 class="font-script text-teal text-5xl mb-3">Become a Partner</h3>
                           <p class="text-medium-text mt-2">We are seeking partners for strategic guidance, technical support, funding, and operational efficiency to help us achieve this vision.</p>
                           <a href="#connect" class="btn btn-outline mt-4 inline-block">Connect With Us</a>
                      </div>
                  </div>
              </div>
        </section>

         <section id="values" class="content-section py-20 md:py-40">
             <div class="container mx-auto px-6 max-w-5xl">
                  <div class="text-center reveal-up mb-20 section-header"> <h2 class="font-script text-gold text-5xl md:text-6xl mb-4">Our Guiding Principles</h2>
                  </div>
                 <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-12 text-center">
                     <div class="reveal-up value-container">
                         <svg class="w-16 h-16 mx-auto value-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a3.004 3.004 0 015.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
                         <h3 class="text-2xl mt-4 font-script text-teal">Collaboration</h3>
                         <p class="text-medium-text mt-2">We build partnerships with local leaders, researchers, and community members to create a holistic approach.</p>
                     </div>
                      <div class="reveal-up value-container">
                         <svg class="w-16 h-16 mx-auto value-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                         <h3 class="text-2xl mt-4 font-script text-teal">Integrity</h3>
                         <p class="text-medium-text mt-2">We uphold the highest standards of accuracy, ensuring users receive trustworthy information.</p>
                     </div>
                      <div class="reveal-up value-container">
                         <svg class="w-16 h-16 mx-auto value-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" /></svg>
                         <h3 class="text-2xl mt-4 font-script text-teal">Inclusivity</h3>
                         <p class="text-medium-text mt-2">We embrace diversity by providing resources in multiple languages, ensuring everyone has access.</p>
                     </div>
                      <div class="reveal-up value-container">
                         <svg class="w-16 h-16 mx-auto value-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /></svg>
                         <h3 class="text-2xl mt-4 font-script text-teal">Innovation</h3>
                         <p class="text-medium-text mt-2">We leverage cutting-edge technologies like AI to continuously enhance our educational offerings.</p>
                     </div>
                 </div>
             </div>
          </section>

        <section id="connect" class="content-section py-20 md:py-40">
              <div class="container mx-auto px-6 space-y-24">
                   <div class="text-center max-w-3xl mx-auto reveal-up section-header">
                     <h2 class="font-script text-gold text-5xl md:text-6xl mb-4">Become a Part of the Solution</h2>
                     <p class="text-xl text-medium-text">Whether you are a community leader, a potential partner, or a researcher, there is a role for you. Let's connect.</p>
                   </div>
                   <div class="max-w-2xl mx-auto reveal-up">
                     <h3 class="font-script text-teal text-4xl mb-6 text-center">Chat with MehfoozBot</h3>
                     <div id="chat-log" class="rounded-t-lg shadow-inner h-[50vh] flex flex-col gap-4 p-4 overflow-y-auto"></div>
                     <div class="bg-card-bg rounded-b-lg p-4 shadow-lg"> <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mb-3" id="prompt-buttons">
                            </div>
                         <form id="chat-form" class="flex gap-3">
                             <input type="text" id="chat-input" placeholder="Ask a friendly question..." class="form-input flex-1 rounded-full py-3 px-5">
                             <button type="submit" class="btn-teal rounded-full px-5 py-3 font-semibold">Send</button>
                         </form>
                     </div>
                   </div>
                   <div class="max-w-xl mx-auto reveal-up">
                     <h3 class="font-script text-teal text-4xl mb-6 text-center">Send a Personal Message</h3>
                     <form id="contact-form" class="space-y-6 text-left">
                           <div>
                             <label for="contact-name" class="block mb-2 font-medium text-medium-text">Your Name</label> <input type="text" name="name" id="contact-name" required class="form-input w-full"> </div>
                           <div>
                             <label for="contact-email" class="block mb-2 font-medium text-medium-text">Your Email</label> <input type="email" name="email" id="contact-email" required class="form-input w-full"> </div>
                            <div>
                                <label for="contact-interest" class="block mb-2 font-medium text-medium-text">I am a...</label> <select name="interest" id="contact-interest" class="form-input w-full"> <option>Community Member</option>
                                    <option>Potential Partner / Investor</option>
                                    <option>Researcher / Institution</option>
                                    <option>Student</option>
                                </select>
                            </div>
                           <div>
                             <label for="contact-message" class="block mb-2 font-medium text-medium-text">Your Message</label> <textarea name="message" id="contact-message" rows="5" required class="form-input w-full"></textarea> </div>
                         <button type="submit" class="w-full btn-teal font-semibold py-4 px-6 rounded-lg">Send with heart</button>
                     </form>
                      <div id="form-success" class="hidden text-center border border-teal rounded-lg p-8 mt-6">
                         <p class="font-script text-teal text-3xl mb-2">Thank You!</p>
                         <p class="text-medium-text">Your message has been received. We'll be in touch soon.</p>
                      </div>
                   </div>
              </div>
        </section>

        <nav id="friendly-nav" class="flex gap-6 text-lg"> <a href="#home" class="nav-link relative">Home</a>
            <a href="#journal" class="nav-link relative">Journal</a>
            <a href="#approach" class="nav-link relative">Approach</a>
            <a href="#community" class="nav-link relative">Community</a>
            <a href="#connect" class="nav-link relative">Connect</a>
        </nav>

    </main>

    <div id="bot-modal" class="hidden fixed inset-0 z-[200] flex items-center justify-center p-4"> <div class="bot-modal-content bg-dark-bg border border-border-color rounded-lg w-full max-w-md p-6 shadow-xl relative"> <button id="close-bot-demo" class="absolute top-3 right-4 text-2xl text-medium-text hover:text-light-text">&times;</button>
             <h3 class="font-script text-gold text-2xl mb-2 text-center">Chat with MehfoozBot</h3>
             <p class="text-medium-text text-sm mb-4 text-center">A simulated demo.</p>
             <div id="modal-chat-log" class="chat-log-class h-64 bg-card-bg rounded p-3 overflow-y-auto mb-4 flex flex-col gap-3"> </div>
             <div id="modal-question-pills" class="question-pills-class flex flex-wrap gap-2 mb-4"> </div>
             <form id="modal-chat-form" class="chat-form-class flex gap-2"> <input type="text" id="modal-chat-input" placeholder="Type your question..." autocomplete="off" class="form-input flex-grow rounded-full">
                 <button type="submit" class="btn btn-primary rounded-full px-4">Send</button>
             </form>
         </div>
     </div>


    <footer id="site-footer">
        <div class="container">
            <p>&copy; 2025 Mehfooz Internet. A digital sanctuary for all.</p>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        gsap.registerPlugin(ScrollTrigger);
        
        const mainContent = document.getElementById('main-content');
        const cursorDot = document.getElementById('cursor-dot');
        const cursorLight = document.getElementById('cursor-light');
        const friendlyNav = document.getElementById('friendly-nav');
        const siteHeader = document.getElementById('site-header'); // Get header element
        
        let mouse = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
        window.addEventListener('mousemove', e => { mouse.x = e.clientX; mouse.y = e.clientY; });
        // Use GSAP ticker for smoother cursor animation
         gsap.ticker.add(() => {
             gsap.to(cursorDot, { duration: 0.2, x: mouse.x, y: mouse.y });
             gsap.to(cursorLight, { duration: 0.5, x: mouse.x, y: mouse.y, ease: 'power2.out' });
         });


        // --- SMOOTH SCROLL ---
        const lenis = new Lenis();
        function raf(time) {
            lenis.raf(time);
            requestAnimationFrame(raf);
        }
        requestAnimationFrame(raf);
        
        // --- *** ALL NAVIGATION LINKS HANDLER *** ---
        // Setup navigation AFTER the site is entered
        function setupNavigation() {
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                // Remove existing listeners first to prevent duplicates
                // anchor.removeEventListener('click', handleNavClick); // Need a named function
                 const handleNavClick = function(e) { // Define named function
                     e.preventDefault();
                     const targetId = this.getAttribute('href');
                     lenis.scrollTo(targetId, { offset: -80 }); // Adjust offset if header height changes
                 };
                 anchor.addEventListener('click', handleNavClick);
            });

             // Header scroll effect (only after site entered)
             ScrollTrigger.create({
                 start: 'top top-=-100', // When scrolling down 100px
                 end: 99999,
                 toggleClass: { className: 'scrolled', targets: siteHeader }
             });

            // Nav link active state highlighting
            gsap.utils.toArray('main section[id]').forEach((section) => {
                 // Kill existing triggers for this section before creating new ones
                 ScrollTrigger.getAll().forEach(trigger => {
                     if (trigger.vars.trigger === section && trigger.vars.onToggle) {
                         trigger.kill();
                     }
                 });
                ScrollTrigger.create({
                    trigger: section,
                    start: 'top center+=100px', // Adjust start/end slightly
                    end: 'bottom center-=100px',
                    // markers: true, // For debugging
                    onToggle: self => {
                         const sectionId = section.getAttribute('id');
                         // Target links in BOTH navs
                         const correspondingLinks = document.querySelectorAll(`.nav-link[href="#${sectionId}"]`);
                         if (correspondingLinks.length > 0) {
                            if (self.isActive) {
                                 // Remove active from all links first
                                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                                 // Add active to current section's links
                                correspondingLinks.forEach(link => link.classList.add('active'));
                            }
                         }
                    }
                });
            });
             // Ensure home is active initially
             document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active')); // Clear all first
             document.querySelectorAll('.nav-link[href="#home"]').forEach(link => link.classList.add('active'));

             // Friendly Nav visibility
             // Kill existing triggers first
             ScrollTrigger.getAll().forEach(trigger => {
                 if (trigger.vars.trigger === 'body' && trigger.vars.onEnter) {
                     trigger.kill();
                 }
             });
             ScrollTrigger.create({
                 trigger: 'body', // Use body as trigger
                 start: 'top top-=-300', // Show a bit earlier
                 end: 'bottom bottom+=200',
                 onEnter: () => friendlyNav.classList.add('visible'),
                 onLeave: () => friendlyNav.classList.remove('visible'), // Hide when reaching bottom
                 onEnterBack: () => friendlyNav.classList.add('visible'),
                 onLeaveBack: () => friendlyNav.classList.remove('visible')
             });

        } // End setupNavigation

        // --- ENHANCED "TRUST OR DOUBT" GAME LOGIC ---
        const gameScreen = document.getElementById('game-screen');
        const gameCard = gameScreen.querySelector('.game-card'); // Target the card
        const gameIntro = document.getElementById('game-intro');
        const gameMain = document.getElementById('game-main');
        const gameEnd = document.getElementById('game-end');
        const gameStartBtn = document.getElementById('game-start-btn');
        const gamePromptEl = document.getElementById('game-prompt');
        const gameStatementEl = document.getElementById('game-statement');
        const gameBtn1 = document.getElementById('game-btn-1');
        const gameBtn2 = document.getElementById('game-btn-2');
        const gameFeedbackEl = document.getElementById('game-feedback');
        const gameButtons = document.getElementById('game-buttons');
        const enterSiteBtn = document.getElementById('enter-site-btn');
        
        const gameData = [
            {
                prompt: "A message flashes on your screen:",
                statement: "URGENT: Your bank account may be compromised! Click this link *immediately* to secure it.",
                buttons: ["Trust", "Doubt"],
                feedback: [
                    "The urge to act fast is strong. Yet, urgency without verification is often a warning sign.",
                    "You hesitated, listening to your inner caution. That pause is powerful. Verify before you click."
                ]
            },
            {
                prompt: "Scrolling through social media, you see a post:",
                statement: "'This simple, natural remedy cures everything! Big companies don't want you to know!'",
                buttons: ["Share It!", "Question It"],
                feedback: [
                    "Sharing feels helpful, but could this claim harm someone if untrue? Seek credible sources first.",
                    "You questioned it. That critical step protects yourself and others. Look for scientific backing."
                ]
            }
        ];
        let gameStep = 0;

         // GSAP Animation Timeline for the game intro
         const gameIntroTl = gsap.timeline({ paused: true });
         gameIntroTl.to(gameCard, { opacity: 1, scale: 1, duration: 0.8, ease: 'back.out(1.7)' })
               .from([gameIntro.children], { opacity: 0, y: 20, stagger: 0.1, duration: 0.5 }, "-=0.3");
         // Play the intro animation immediately
         gameIntroTl.play();


         function loadGameStep(stepIndex) {
             const step = gameData[stepIndex];
             const tl = gsap.timeline();

             // Fade out current step elements
             tl.to([gamePromptEl, gameStatementEl, gameButtons, gameFeedbackEl], {
                 opacity: 0,
                 y: -10, // Move slightly up on fade out
                 duration: 0.4,
                 stagger: 0.05,
                 ease: 'power2.in'
             });

             // Update content during fade out
             tl.call(() => {
                 gamePromptEl.textContent = step.prompt;
                 gameStatementEl.textContent = step.statement;
                 gameBtn1.textContent = step.buttons[0];
                 gameBtn2.textContent = step.buttons[1];
                 gameFeedbackEl.textContent = ''; // Clear feedback

                 // Re-enable buttons and reset opacity (will be faded in)
                 gameBtn1.disabled = false;
                 gameBtn2.disabled = false;
                 gsap.set([gameBtn1, gameBtn2], { opacity: 1 }); // Reset opacity immediately

                 // Assign new click handlers
                 gameBtn1.onclick = () => handleChoice(0);
                 gameBtn2.onclick = () => handleChoice(1);
             }, null, ">"); // Ensure call happens after fade out starts

             // Fade in new step elements
             tl.fromTo([gamePromptEl, gameStatementEl, gameButtons], { y: 10, opacity: 0 }, {
                 opacity: 1,
                 y: 0,
                 duration: 0.6,
                 stagger: 0.1,
                 ease: 'power2.out'
             });
         }
        
         function handleChoice(choiceIndex) {
             const feedback = gameData[gameStep].feedback[choiceIndex];

             // Disable buttons and animate feedback
             gameBtn1.disabled = true;
             gameBtn2.disabled = true;
             gsap.to([gameBtn1, gameBtn2], { opacity: 0.4, duration: 0.3 }); // Dim buttons

             gsap.fromTo(gameFeedbackEl,
                 { opacity: 0, y: 10 },
                 {
                     opacity: 1, y: 0, duration: 0.6, ease: 'power2.out',
                     onStart: () => { gameFeedbackEl.textContent = feedback; } // Set text as animation starts
                 }
             );


             setTimeout(() => {
                 gameStep++;
                 if (gameStep < gameData.length) {
                      loadGameStep(gameStep); // Load next step uses its own timeline
                 } else {
                     showGameEnd();
                 }
             }, 3500); // Time to read feedback
         }

        function showGameEnd() {
             const tl = gsap.timeline();
             tl.to(gameMain, { opacity: 0, duration: 0.5, ease: 'power2.in' })
               .call(() => {
                    gameMain.style.display = 'none'; // Use display none for layout
                    gameEnd.classList.remove('hidden');
               })
               .from(gameEnd.children, { opacity: 0, y: 20, stagger: 0.15, duration: 0.8, ease: 'back.out(1.7)' });
        }

        gameStartBtn.addEventListener('click', () => {
             const tl = gsap.timeline();
             tl.to(gameIntro, { opacity: 0, duration: 0.5, ease: 'power2.in' })
               .call(() => {
                    gameIntro.style.display = 'none'; // Use display none
                    gameMain.classList.remove('hidden');
               })
               // Animate the appearance of the first game step elements
               .fromTo([gamePromptEl, gameStatementEl, gameButtons],
                     { opacity: 0, y: 10 },
                     { opacity: 1, y: 0, duration: 0.6, stagger: 0.1, ease: 'power2.out',
                       onStart: () => loadGameStep(0) // Load content just before animation
                     });
        });

         enterSiteBtn.addEventListener('click', () => {
              gsap.to(gameScreen, {
                  opacity: 0,
                  duration: 1.2, // Slower fade for smoother transition
                  ease: 'power2.inOut',
                  onComplete: () => {
                      gameScreen.style.display = 'none';
                      document.body.classList.add('site-entered'); // Add class to body
                      
                      // Initialize site elements (start hidden, then fade in)
                      gsap.set(mainContent, { opacity: 0 });
                      gsap.set(siteHeader, { opacity: 0, y: '-100%' }); // Ensure header is hidden
                      
                      gsap.to(mainContent, { opacity: 1, duration: 1.5, ease: 'power2.out' });
                      gsap.to(siteHeader, { opacity: 1, y: 0, duration: 1, ease: 'power2.out', delay: 0.5 }); // Fade in header slightly later
                      
                      // *** IMPORTANT: Setup nav and animations AFTER site is visible ***
                      setupNavigation();
                      initSiteAnimations();
                  }
              });
         });
        
        // --- THREE.JS BACKGROUND (Keep if desired) ---
        // (Assuming Three.js library is loaded via CDN)
        try {
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;
            const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('bg-canvas'), alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

            const particleCount = 7000;
            const positions = new Float32Array(particleCount * 3);
            const colors = new Float32Array(particleCount * 3);
            // Get colors from CSS Variables
            const colorGold = new THREE.Color(getComputedStyle(document.documentElement).getPropertyValue('--gold').trim());
            const colorTeal = new THREE.Color(getComputedStyle(document.documentElement).getPropertyValue('--teal').trim());

            for(let i = 0; i < particleCount; i++) {
                const i3 = i * 3;
                positions[i3] = (Math.random() - 0.5) * 25; // Spread particles wider
                positions[i3 + 1] = (Math.random() - 0.5) * 25;
                positions[i3 + 2] = (Math.random() - 0.5) * 25;
                
                // Mix colors - More teal overall with gold highlights
                const mixedColor = Math.random() > 0.85 ? colorGold.clone() : colorTeal.clone().lerp(colorGold, Math.random() * 0.2);
                colors[i3] = mixedColor.r;
                colors[i3 + 1] = mixedColor.g;
                colors[i3 + 2] = mixedColor.b;
            }
            const particlesGeometry = new THREE.BufferGeometry();
            particlesGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            particlesGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            
            const particlesMaterial = new THREE.PointsMaterial({
                size: 0.02, // Smaller particles
                sizeAttenuation: true,
                transparent: true,
                opacity: 0.5, // Slightly less opaque
                vertexColors: true,
                depthWrite: false // Helps with transparency blending
            });
            const particles = new THREE.Points(particlesGeometry, particlesMaterial);
            scene.add(particles);

             // Subtle Animation Loop
             let clock = new THREE.Clock();
             function animateBackground() { // Renamed to avoid conflict
                 const elapsedTime = clock.getElapsedTime();
                 const scrollY = lenis.scroll;

                 // Slow rotation + mouse movement + scroll effect
                 particles.rotation.y = elapsedTime * 0.02 + scrollY * 0.0001;
                 particles.rotation.x = elapsedTime * 0.01 + (mouse.y / window.innerHeight - 0.5) * 0.05; // Mouse affects X rotation
                 particles.position.y = -scrollY / window.innerHeight * 1.5; // Adjust scroll effect intensity

                 renderer.render(scene, camera);
                 requestAnimationFrame(animateBackground);
             }
            animateBackground(); // Start the background animation loop

            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            });
        } catch (e) {
            console.error("Three.js initialization failed:", e);
             // Hide canvas if it fails
             document.getElementById('bg-canvas').style.display = 'none';
        }


        // --- MAIN SITE ANIMATIONS (Function to be called later) ---
        function initSiteAnimations() { // Renamed function
            console.log("Initializing main site animations..."); // Debug log

            // Hero Text & Scroll Prompt (Re-run if needed, ensure visibility)
            // Splitting needs to happen if not already done, but should be fine
             const existingHeroHeadline = SplitType.revert('#hero-headline'); // Revert if exists
             const heroHeadlineSplit = new SplitType('#hero-headline', { types: 'lines' });
             gsap.set(heroHeadlineSplit.lines, { y: '110%' }); // Ensure starting pos
             gsap.set('#hero-headline .line', { 'clip-path': 'polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)' }); // Ensure clip

             gsap.timeline({ delay: 0.2 }) // Slight delay after site appears
                 .to(heroHeadlineSplit.lines, { y: '0%', stagger: 0.1, duration: 1.2, ease: 'power3.out' })
                 .to('#hero-headline', { opacity: 1 }, '<') // Ensure opacity during animation
                 .fromTo('#hero-subheadline', { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 1, ease: 'power2.out' }, '-=0.8')
                 .to('#scroll-prompt', { opacity: 1, duration: 1, delay: 0.5 }, '-=0.8');


            // Section reveal animations (Headers, Forms)
            gsap.utils.toArray('.section-header, #contact-form').forEach(elem => { // Include form here
                gsap.fromTo(elem, { opacity: 0, y: 50 }, {
                    opacity: 1,
                    y: 0,
                    duration: 1.2, // Slightly longer duration
                    ease: 'power3.out',
                    scrollTrigger: {
                        trigger: elem,
                        start: 'top 88%', // Trigger slightly later
                    }
                });
            });
            
             // Staggered Card Reveals (Pillars, Insights, Values)
             gsap.utils.toArray('.pillar-card, .insight-card, .value-container').forEach((card, i) => {
                  gsap.fromTo(card,
                     { opacity: 0, y: 60, scale: 0.98 }, // Start slightly scaled down
                     {
                         opacity: 1,
                         y: 0,
                         scale: 1,
                         duration: 1.0, // Slightly faster
                         ease: 'power3.out',
                         delay: (i % 3) * 0.1, // Reduced stagger delay
                         scrollTrigger: {
                             trigger: card.parentElement.closest('section, div.grid'), // Trigger on parent grid or section
                             start: 'top 85%', // Adjust trigger point
                             // markers: true,
                             toggleActions: 'play none none none' // Only play once
                         }
                     }
                 );
             });
            
            // Image parallax/reveal
             // Ensure this targets the correct containers now
             gsap.utils.toArray('.journal-image-container').forEach(container => {
                  const img = container.querySelector('img');
                 if (img) {
                      // Reveal Animation
                     gsap.fromTo(container,
                         { clipPath: 'inset(10% 30% 10% 30%)', opacity: 0 },
                         {
                             clipPath: 'inset(0% 0% 0% 0%)',
                             opacity: 1,
                             duration: 1.8, // Slower reveal
                             ease: 'power4.out',
                             scrollTrigger: {
                                 trigger: container,
                                 start: 'top 85%'
                             }
                     });
                     // Parallax
                     gsap.to(img, {
                         yPercent: -10, // Parallax effect
                         scale: 1, // Ensure scale returns to 1 if it started differently
                         ease: 'none',
                         scrollTrigger: {
                             trigger: container.closest('section'), // Trigger based on section scroll
                             scrub: true,
                             start: 'top bottom', // Start parallax when section enters viewport
                             end: 'bottom top'   // End parallax when section leaves
                         }
                     });
                 }
            });


            // Vision Counter Animation
            gsap.to("#user-counter", {
                textContent: 100000,
                duration: 3,
                ease: "power2.inOut", // Smoother ease
                snap: { textContent: 1 },
                scrollTrigger: {
                    trigger: "#user-counter",
                    start: "top 80%",
                },
                // Use .toLocaleString for commas
                onUpdate: function() {
                    this.targets()[0].innerHTML = Math.ceil(this.targets()[0].textContent).toLocaleString('en-US') + "+";
                }
            });

             // Blockquote reveal
             gsap.utils.toArray('blockquote').forEach((quote, i) => {
                 gsap.from(quote, {
                     opacity: 0,
                     x: i % 2 === 0 ? -50 : 50, // Alternate entry direction
                     duration: 1,
                     ease: 'power3.out',
                     scrollTrigger: {
                         trigger: quote,
                         start: 'top 85%'
                     }
                 });
             });

        } // End initSiteAnimations function
        
        // --- SMARTER MEHFOOZBOT LOGIC ---
        const chatLog = document.getElementById('chat-log');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const promptButtonsContainer = document.getElementById('prompt-buttons');
         // Also handle modal bot elements if they exist
         const modalBotDemoButton = document.getElementById('open-bot-demo-approach'); // Example button ID
         const modalChatLog = document.getElementById('modal-chat-log');
         const modalChatForm = document.getElementById('modal-chat-form');
         const modalChatInput = document.getElementById('modal-chat-input');
         const modalPillContainer = document.getElementById('modal-question-pills');
         const botModal = document.getElementById('bot-modal');
         const closeBotBtn = document.getElementById('close-bot-demo');


        const botResponses = {
            "greeting": "Hello, friend. It's wonderful to connect with you. How can I help you find clarity today?",
            "default": "That's a lovely question. While my abilities here are a demonstration, the full MehfoozBot can share stories and guidance on that. Every question is a step toward clarity.",
            "misinformation": "To spot misinformation, it's helpful to pause and check the source, look for evidence, and notice if the story tries to make you feel strong emotions. A calm mind is a clear mind.",
            "safety": "To stay safe online, it's wise to use strong, unique passwords and be cautious about sharing personal information. Think of your data as something precious you wouldn't leave unattended.",
            "story": "Our story began with conversations in teahouses, listening to the hopes and worries of the community. You can read more in the 'From Our Journal' section above.",
            "ulema": "We partner with trusted local Ulema (religious leaders). They act as digital literacy ambassadors, bridging traditional knowledge with modern skills to create unprecedented community acceptance."
        };
        const promptQuestions = { // Used for buttons
            "How do you work?": "ulema",
            "What's your story?": "story",
            "Spotting fake news?": "misinformation", // Shorter text
            "Staying safe online?": "safety" // Shorter text
        };
         const modalQuestions = [ // Questions for modal pills (if used)
             "How can I spot fake news?",
             "Is my WhatsApp safe?",
             "What is misinformation?"
         ];


        function getBotResponse(userInput) {
            const lowerInput = userInput.toLowerCase();
             // Match based on shorter prompt text keys first
             for (const [prompt, key] of Object.entries(promptQuestions)) {
                 if (userInput === prompt) return botResponses[key];
             }
              // Match based on modal pill questions
              if (modalQuestions.includes(userInput)) {
                  if (userInput.includes('fake news') || userInput.includes('misinformation')) return botResponses.misinformation;
                  if (userInput.includes('WhatsApp') || userInput.includes('safe')) return botResponses.safety;
              }
             // Then check keywords
            if (lowerInput.includes('fake news') || lowerInput.includes('misinformation')) return botResponses.misinformation;
            if (lowerInput.includes('safe') || lowerInput.includes('whatsapp') || lowerInput.includes('security')) return botResponses.safety;
            if (lowerInput.includes('story') || lowerInput.includes('who are you') || lowerInput.includes('why')) return botResponses.story;
            if (lowerInput.includes('ulema') || lowerInput.includes('leaders') || lowerInput.includes('work')) return botResponses.ulema;
            if (lowerInput.includes('hello') || lowerInput.includes('hi')) return botResponses.greeting;
            return botResponses.default;
        }

         // Generic function to add message to a specific chat log
         function addChatMessage(message, sender, targetLog, isImmediate = false) {
             if (!targetLog) return; // Add check if targetLog exists
             const bubble = document.createElement('div');
             bubble.className = `chat-bubble ${sender}-bubble`;
             bubble.textContent = message;
             targetLog.appendChild(bubble);
             gsap.from(bubble, { opacity: 0, y: 20, duration: 0.5, delay: isImmediate ? 0 : 0.2 });
             // Check if scrollTo plugin is available or use native scroll
              gsap.to(targetLog, { duration: 0.5, scrollTo: { y: "max", autoKill: false }, ease: "power2.out" });
         }

        // Generic function to handle user input for a specific chat instance
         function handleBotUserInput(input, targetLog, targetInput, targetPromptsContainer) {
             if (!targetLog || !targetInput) return; // Add checks
             if(input.trim()){
                 addChatMessage(input, 'user', targetLog, true);
                 targetInput.value = '';
                 targetInput.disabled = true;
                  if (targetPromptsContainer) { // Disable prompt buttons if they exist
                      targetPromptsContainer.style.pointerEvents = 'none';
                      gsap.to(targetPromptsContainer.children, { opacity: 0.5, duration: 0.3 });
                  }

                 // Simulate thinking (typing indicator could be added here)
                 setTimeout(() => {
                     const response = getBotResponse(input);
                     addChatMessage(response, 'bot', targetLog);
                     targetInput.disabled = false;
                      if (targetPromptsContainer) { // Re-enable prompt buttons
                          targetPromptsContainer.style.pointerEvents = 'auto';
                          gsap.to(targetPromptsContainer.children, { opacity: 1, duration: 0.3 });
                      }
                     targetInput.focus();
                 }, 1000 + Math.random() * 400); // Slightly faster bot response
             }
         }

         // Setup for Inline Bot
         if (chatLog && chatForm && chatInput && promptButtonsContainer) {
             chatForm.addEventListener('submit', e => {
                  e.preventDefault();
                  handleBotUserInput(chatInput.value, chatLog, chatInput, promptButtonsContainer);
             });
             // Add prompt buttons to inline chat
             Object.keys(promptQuestions).forEach(question => {
                 const button = document.createElement('button');
                 button.type = "button"; // Prevent form submission
                 button.className = "chat-prompt-btn text-sm rounded-full py-2 px-3";
                 button.textContent = question;
                 button.onclick = () => { handleBotUserInput(question, chatLog, chatInput, promptButtonsContainer); } // Pass correct args
                 promptButtonsContainer.appendChild(button);
             });
             // Initial inline bot message
             addChatMessage(botResponses.greeting, 'bot', chatLog, true);
         }


         // Setup for Modal Bot (if elements exist)
         if (botModal && modalChatLog && modalChatForm && modalChatInput && modalPillContainer && closeBotBtn) {
              modalChatForm.addEventListener('submit', e => {
                   e.preventDefault();
                   handleBotUserInput(modalChatInput.value, modalChatLog, modalChatInput, modalPillContainer);
              });

              // Add pills to modal
              modalQuestions.forEach(q => {
                  const pill = document.createElement('div');
                  pill.className = 'question-pill cursor-pointer border border-medium-text text-medium-text hover:bg-teal hover:border-teal hover:text-white transition-colors rounded-full px-3 py-1 text-sm'; // Added styles
                  pill.textContent = q;
                  pill.dataset.question = q;
                   pill.onclick = () => { handleBotUserInput(q, modalChatLog, modalChatInput, modalPillContainer); };
                  modalPillContainer.appendChild(pill);
              });

              // Open Modal Button(s)
              const openModalButtons = document.querySelectorAll('#open-bot-demo-approach'); // Add more selectors if needed
              openModalButtons.forEach(btn => {
                  btn.addEventListener('click', () => {
                      botModal.classList.remove('hidden');
                      // Optional: Add initial message if log is empty
                       if (modalChatLog.children.length === 0) {
                           addChatMessage("Hello! Ask a question or click a topic.", 'bot', modalChatLog, true);
                       }
                      gsap.fromTo(botModal, {opacity: 0}, {opacity: 1, duration: 0.3}); // Animate modal itself
                      gsap.fromTo(botModal.querySelector('.bot-modal-content'), {scale: 0.9, opacity: 0}, {scale: 1, opacity: 1, duration: 0.3, ease: 'power2.out'});
                  });
              });

              // Close Modal Button
              closeBotBtn.addEventListener('click', () => {
                   gsap.to(botModal.querySelector('.bot-modal-content'), {scale: 0.9, opacity: 0, duration: 0.3, ease: 'power2.in', onComplete: () => {
                       gsap.to(botModal, {opacity: 0, duration: 0.2, onComplete: () => {
                             botModal.classList.add('hidden');
                       }});
                   }});
              });
         }


        // --- CONTACT FORM LOGIC ---
        const contactForm = document.getElementById('contact-form');
        const formSuccess = document.getElementById('form-success');
        if (contactForm && formSuccess) { // Check if form exists
            contactForm.addEventListener('submit', e => {
                 e.preventDefault();
                 // Add subtle animation before hiding
                 gsap.to(contactForm, { height: contactForm.offsetHeight, duration: 0.5, ease: 'power2.inOut', onComplete: () => {
                     gsap.to(contactForm, { opacity: 0, duration: 0.3, onComplete: () => {
                         contactForm.style.display = 'none';
                         formSuccess.classList.remove('hidden');
                         gsap.set(formSuccess, { height: 'auto' }); // Set height before animating
                         gsap.from(formSuccess, { opacity: 0, height: 0, duration: 0.6, ease: 'power2.out' });
                     }});
                 }});
            });
        }

         // --- Initial Setup ---
         // Ensure main content is hidden until game ends
         gsap.set(mainContent, { opacity: 0 });
         // Hide floating nav initially
         gsap.set(friendlyNav, { y: '200%' }); // Start further down


    }); // End DOMContentLoaded
    </script>
</body>
</html>
